# [프로젝트 사례] 글로벌 API 호출 최적화 및 응답 데이터 개선

## 1. 배경
- **프로젝트 설명:**  
  모든 페이지에서 호출되는 `globalprocess` API는 사이트 기본 뷰와 이벤트 구성을 위한 데이터를 JSON 객체 형태로 제공했습니다.  
- **문제 상황:**  
  - 기존 API의 응답시간은 372ms, 데이터 크기는 32.6kb로 나타나 다소 비효율적이었습니다.  
  - 불필요한 데이터 키들이 응답에 포함되어 응답 크기를 불필요하게 증가시켰습니다.  
  - 로고, 배너 등 상대적으로 정적인 데이터가 매번 재구성되어 응답 속도 저하에 영향을 미쳤습니다.  
  - 특히 배너의 경우, 유저의 상태별로 다르게 전달되어야 하는 조건이 있어 구현에 어려움이 있었습니다.  
- **작업 기간:**  
  2023.11

## 2. 사용 기술
- **프로그래밍 언어:** `node.js`
- **캐싱 기법:** 서버 측 캐싱 (파일 캐시)

## 3. 문제 해결 과정
- **문제 진단:**  
  - 전체 응답 데이터 내 사용하지 않는 데이터 키들이 포함되어 있음을 파악.  
  - 정적인 데이터(로고, 배너 등)가 매번 동적 처리되는 문제로 응답 속도 저하 발생.  
  - 배너의 경우, 유저 상태별로 서로 다른 조건을 반영해야 하는 복잡한 요구사항이 존재함.
  
- **해결 전략:**  
  - **데이터 최적화:**  
    프론트엔드 팀과 협의하여 불필요한 데이터 키들을 제거하고, 응답 JSON 구조를 간소화하였습니다.
  - **서버 캐싱 도입:**  
    로고와 배너와 같이 잘 변하지 않는 정적 데이터를 서버에서 캐싱하여, API 호출 시 재구성을 최소화했습니다.
  - **조건 기반 배너 전달:**  
    - 미리 캐싱된 배너 목록에 각 배너의 노출 조건 정보를 함께 저장했습니다.  
    - API 호출 시, 사용자의 상태에 맞는 배너를 캐싱된 목록에서 필터링하여 전달하는 로직을 구현하였습니다.

- **구현 및 테스트:**  
  - API 응답 JSON 구조를 개선하여, 사용하지 않는 데이터를 제거하고 필요한 데이터만 포함하도록 수정했습니다.  
  - 캐싱 로직을 도입하여 정적 데이터를 별도로 저장하고, 불필요한 DB 조회 및 데이터 재구성을 줄였습니다.  
  - 유저 조건에 따른 배너 필터링 로직을 구현한 후, 다양한 유저 시나리오를 테스트하여 올바른 배너가 전달되는지 확인했습니다.

## 4. 성과 및 결과
- **응답시간 개선:**  
  API 응답시간이 기존 372ms에서 203ms로 단축되었습니다.
- **데이터 크기 감소:**  
  JSON 응답 데이터의 크기가 32.6kb에서 17.0kb로 줄어들어 네트워크 부하가 크게 감소하였습니다.
- **사용자 경험 향상:**  
  빠른 데이터 응답으로 사이트 기본 뷰 로딩 및 이벤트 페이지 구성 속도가 개선되어 사용자 만족도가 증가하였습니다.
- **효율적 데이터 관리:**  
  서버 캐싱과 조건 기반 배너 전달 방식을 통해 API 유지보수 및 확장성이 크게 향상되었습니다.
